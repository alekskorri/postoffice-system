<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <title>Order Management</title>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="{% static 'css/home.css' %}" rel="stylesheet" type="text/css"/>
</head>
<body>
{% include 'navbar.html' %}

<main class="flex-grow-1">
{% block content %}
  <h1 class="text-center fancy-title">HOME</h1>

    <div class="container" id="home">
    <h2>Orders List</h2>

    {% if user.is_superuser %}
    <form method="get" class="mb-3">
        <div class="form-group">
            <select name="shop" id="shop" class="form-control" onchange="this.form.submit()">
                <option value="">All Shops</option>
                {% for shop in shops %}
                <option value="{{ shop.id }}" {% if request.GET.shop == shop.id|stringformat:"s" %} selected {% endif %}>
                {{ shop.username }}</option>
                {% endfor %}
            </select>
        </div>
    </form>
    {% endif %}

    <table class="table table-secondary table-striped">
        <thead class="table-dark">
        <tr>
            <th scope="col">Nr.</th>
            <th scope="col">Shop</th>
            <th scope="col">Product</th>
            <th scope="col">Client</th>
            <th scope="col">Ordered Time</th>
            <th scope="col"></th>
            <th scope="col"></th>
            <th scope="col"></th>

        </tr>
        </thead>


        <tbody>
        {% for data in page_obj %}
        <tr>
            <th scope="row">{{ forloop.counter|add:page_obj.start_index|add:"-1" }}</th>
            <th scope="row">{{ data.shop }}</th>
            <th scope="row">{{ data.product }}</th>
            <th scope="row">{{ data.client }}</th>
            <th scope="row">{{ data.ordered_time|date:"M d, Y H:i:s" }}</th>
            <th scope="row"><a class="btn btn-info" href="{% url 'info' data.id %}">Info</a></th>
            {% if user.is_superuser %}
            <th scope="row"><a class="btn btn-success" href="{% url 'mark_order_sent' data.id %}">Sent</a></th>
            <th scope="row"><a class="btn btn-danger" href="{% url 'mark_order_cancelled' data.id %}">Cancelled</a></th>
            {% else %}
            <th scope="row"><a class="btn btn-warning" href="{% url 'edit' data.id %}">Edit</a></th>
            <th scope="row"><a class="btn btn-danger" href="{% url 'delete' data.id %}">Delete</a></th>
            {% endif %}
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if page_obj.has_previous %}
            <li class="page-item"><a class="page-link" href="?page=1{% if request.GET.shop %}&shop={{ request.GET.shop }}{% endif %}">&laquo;&laquo; First</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if request.GET.shop %}&shop={{ request.GET.shop }}{% endif %}">&laquo; Previous</a></li>
            {% endif %}
            {% for num in page_obj.paginator.page_range %}
            <li class="page-item {% if page_obj.number == num %}active{% endif %}"><a class="page-link" href="?page={{ num }}{% if request.GET.shop %}&shop={{ request.GET.shop }}{% endif %}">{{ num }}</a></li>
            {% endfor %}
            {% if page_obj.has_next %}
            <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}{% if request.GET.shop %}&shop={{ request.GET.shop }}{% endif %}">Next &raquo;</a></li>
            <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.shop %}&shop={{ request.GET.shop }}{% endif %}">Last &raquo;&raquo;</a></li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endblock %}
  </main>

{% include 'footer.html' %}

</body>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
</html>